[{"name":"/#Logic/UpdateProvinceData","nodes":[{"id":"5abb5ad2-ca82-d3f1-be88-a0685d4baa0f","type":"JavaScriptFunction","parameters":{"functionScript":"const data = Inputs.data;\r\n\r\nfunction extractProvincesFromObject(data) {\r\n    return data?.Provinces?.map(province => ({\r\n        name: province.FullName,\r\n        location: {\r\n            lat: parseFloat(province.Latitude) || 0,\r\n            lng: parseFloat(province.Longitude) || 0,\r\n        },\r\n    }));\r\n}\r\n\r\nfunction extractProvincesFromArray(data) {\r\n    const seen = new Set();\r\n    return data.flatMap((item) =>\r\n        item.Provinces.map((province) => ({\r\n            name: province.FullName,\r\n            location: {\r\n                lat: parseFloat(province.Latitude) || 0,\r\n                lng: parseFloat(province.Longitude) || 0,\r\n            },\r\n        }))\r\n    ).filter(province => {\r\n        if (seen.has(province.name)) {\r\n            return false;\r\n        } else {\r\n            seen.add(province.name);\r\n            return true;\r\n        }\r\n    });\r\n}\r\n\r\nif (data) {\r\n    const provinces = Array.isArray(data) \r\n        ? extractProvincesFromArray(data)\r\n        : extractProvincesFromObject(data);\r\n\r\n    const oldProvinces = JSON.parse(localStorage.getItem(\"provinces\")) || [];\r\n\r\n    if (JSON.stringify(provinces) === JSON.stringify(oldProvinces)) {\r\n        Outputs.Success = true;\r\n        return;\r\n    } \r\n    \r\n    if (provinces !== undefined) {\r\n        localStorage.setItem(\"provinces\", JSON.stringify(provinces));\r\n        Outputs.ProvinceList = JSON.stringify(provinces);\r\n        Outputs.Success = true;\r\n        return;\r\n    }\r\n}"},"ports":[{"name":"in-data","displayName":"data","plug":"input","type":"*","group":"Inputs","index":4},{"name":"out-ProvinceList","displayName":"ProvinceList","plug":"output","type":"*","group":"Outputs","index":5},{"name":"out-Success","displayName":"Success","plug":"output","type":"*","group":"Outputs","index":6}],"children":[]},{"id":"6abd86d0-4795-ac36-8962-0840450825f2","type":"Component Inputs","parameters":{},"ports":[],"children":[]},{"id":"7b990f49-74b6-14a5-f064-3bc2830a3ac7","type":"Component Outputs","parameters":{},"ports":[],"children":[]}],"connections":[{"sourceId":"6abd86d0-4795-ac36-8962-0840450825f2","sourcePort":"Data","targetId":"5abb5ad2-ca82-d3f1-be88-a0685d4baa0f","targetPort":"in-data"},{"sourceId":"5abb5ad2-ca82-d3f1-be88-a0685d4baa0f","sourcePort":"out-Success","targetId":"7b990f49-74b6-14a5-f064-3bc2830a3ac7","targetPort":"Success"},{"sourceId":"5abb5ad2-ca82-d3f1-be88-a0685d4baa0f","sourcePort":"out-ProvinceList","targetId":"7b990f49-74b6-14a5-f064-3bc2830a3ac7","targetPort":"ProvinceList"},{"sourceId":"6abd86d0-4795-ac36-8962-0840450825f2","sourcePort":"Data","targetId":"5abb5ad2-ca82-d3f1-be88-a0685d4baa0f","targetPort":"run"}],"ports":[{"name":"Success","type":"*","plug":"output","index":1},{"name":"Data","type":{"name":"signal","allowConnectionsOnly":true},"plug":"input","index":1},{"name":"ProvinceList","type":"*","plug":"output","index":2}],"roots":[]}]